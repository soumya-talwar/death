<html>

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>death bot</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js" integrity="sha512-N4kV7GkNv7QR7RX9YF/olywyIgIwNvfEe2nZtfyj73HdjCUkAfOBDbcuJ/cTaN04JKRnw1YG1wnUyNKMsNgg3g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://unpkg.com/ml5@latest/dist/ml5.min.js"></script>
    <script>
      function setup() {
        let sentences = loadStrings("http://127.0.0.1:3000/text/tweets.txt");
        let starts = [];
        for (sentence of sentences) {
          let words = sentence.split(" ");
          starts.push(words[0]);
        }
        let start = starts[Math.floor(Math.random() * starts.length)] + " ";
        const charrnn = ml5.charRNN("./char-rnn/models/input", () => {
          let tweet = "";
          const sentiment = ml5.sentiment("movieReviews", () => {
            let tweet = "";
            charrnn.generate({
              seed: start,
              length: Math.floor(Math.random() * (280 - 100) + 100),
              temperature: 0.5
            }, (error, result) => {
              if (error)
                console.log(error);
              else {
                tweet = start + result.sample;
                console.log("tweet: " + tweet);
                let prediction = sentiment.predict(tweet).score;
                console.log("prediction: " + prediction);
              }
            });
          });
        });
      }
    </script>
  </head>

</html>